## 概念

### 0. 技术规格

  1. 文本

    - ***文本*** 是一段文字

    > 这是一段文本

  2. HTML

    - ***HTML*** 是由 ***文本*** + ***标记*** 构成的信息

    - ***标记*** 可以用来标明 ***文本*** 的额外信息，比如 ***文本*** 的颜色、***文本*** 的从属关系

    > ```html
    > <p>这是一段 <i>HTML</i> 文本</p>
    > <ul>
    >   <li>这个</li>
    >   <li>用来表示</li>
    >   <li>列表</li>
    > </ul>
    > ```

  3. Unix 时间戳

    - ***Unix 时间戳*** 是表达时间点的方式

    - ***Unix 时间戳*** 是时间原点到另一个时间点的相差秒数

    - ***Unix 时间戳*** 不包含时区信息

    > Unix 时间戳 | 时间
    > -----------| ----
    > 1428185829 | Sun Apr 05 2015 06:17:09 GMT+0800 (CST)
    > 1428185971 | Sun Apr 05 2015 06:19:31 GMT+0800 (CST)


  4. WYSIWYG

    - 所见即所得编辑器

    > 图 1. TinyMCE

### 1. 事件组

  - 1 个 ***事件组*** 有 1 段 ***HTML 文本***

  - 1 个 ***事件组*** 有 1 个 ***时锚***

  - 1 个 ***事件组*** 有多个 ***图片***

  - ***事件组*** 的 ***HTML 文本*** 中，使用 ***标记*** 注明特定 ***文本*** 的 ***出处***

  - ***出处*** 可以是：注释、出版物出处

### 2. 时锚

  - 1 个 ***时锚*** 有 4 个 ***Unix 时间戳***，分别是：起始的起始、起始的结束、结束的起始、结束的结束

  - 1 个 ***时锚*** 有 1 个 ***时间单位***

  - ***时间单位*** 可以是：年、年代、世纪、千年

  - 对于相邻的两个 ***事件组***，第一个 ***事件组*** 的 ***时锚*** 的结束的结束与第二个 ***事件组*** 的 ***时锚*** 的的起始的起始相同

### 3. 电子书

  - 1 本 ***电子书*** 有多个 ***事件组***

  - 1 本 ***电子书*** 有 1 个 ***电子书名称***

  - 1 本 ***电子书*** 有 1 个 ***可变***

  - 1 本 ***电子书*** 有 1 个 ***语种***

  > 图 2. 数据结构关系

## 编辑系统

### 0. 原则

  - ***编辑系统*** 用于生成 ***展示系统*** 显示的 ***电子书***

### 1. 事件组工具

  - ***事件组工具*** 完成对 1 个 ***事件组*** 的修改

  - ***事件组*** 中的 ***HTML 文本*** 使用 ***定制 WYSIWYG*** 录入

  - ***事件组*** 中的 ***时锚*** 使用 ***时锚工具*** 录入

  - ***事件组*** 中的 ***图片*** 使用 ***图片选择工具*** 录入

  > 图 3. 事件组工具

### 2. 电子书工具

  - 使用 ***电子书工具*** 打开 ***电子书*** 进行编辑

  - 1 个 ***电子书工具*** 同时只能打开 1 本 ***电子书***

  - ***电子书工具*** 显示打开的 ***电子书*** 中，全部 ***事件组***

  - ***电子书工具*** 完成对 1 本 ***电子书*** 中的 ***事件组*** 的增加与删除工作

  - 通过 ***电子书工具*** 打开 ***事件组工具*** 对 ***事件组*** 进行编辑

  > 图 4. 电子书工具

### 3. 定制 WYSIWYG 工具

  - 加入 ***出处标记*** 的录入功能

  - ***出处*** 包围一段 ***事件*** 的 ***文本***

  - ***出处*** 有 1 段 ***标注文字***

  - ***标注文字*** 是一段文本

  > 图 5. 出处标记工具


### 4. 时锚工具

  - ***时锚工具*** 录入 ***时锚*** 的 4 个 ***Unix 时间戳***

  - ***时锚工具*** 录入 ***时锚*** 的 ***时间单位***

  > 图 6. 时锚工具

## 展示系统

### 0. 原则

  - ***展示系统*** 显示多本 ***电子书*** 中全部的 ***事件组*** 与 ***Meta 时间轴***

  - ***展示系统*** 可以进行的 ***操作*** 有：加入 ***电子书***、移除 ***电子书***、调整 ***电子书*** 的 ***相对时间原点***

  - ***展示系统*** 在进行 ***操作*** 后，重绘全部 ***电子书***

  - ***事件组*** 不得重叠

  > 图 7. 展示系统布局

### 1. Meta 时间轴

  - 1 个 ***Meta 时间轴*** 有多个 ***Unix 时间戳***

  - ***Meta 时间轴*** 中，两个 ***Unix 时间戳*** 的显示间距相等

  - ***Meta 时间轴*** 的 ***Unix 时间戳***，来自 ***展示系统*** 显示的全部 ***事件组*** 的 ***时锚***

  > 图 8. Meta 时间轴示意

### 2. 事件组

  - ***事件组*** 的 ***时锚*** 的 ***Unix 时间戳*** 决定 ***事件组*** 所在 ***Meta 时间轴*** 上的位置

  - 当鼠标停留到被标注为 ***出处*** 的文本时，显示 ***标注文字***

  > 图 9. 单独事件组

### 3. 相对时间原点

  - ***展示系统*** 中，具有 ***可变*** 属性的 ***电子书*** 包含 1 个 ***相对时间原点***

  - ***相对时间原点*** 是 1 个 ***Unix 时间戳***

  - 调整 ***相对时间原点*** 后，将 ***相对时间原点*** 与所属 ***电子书*** 的每个 ***事件组*** 的 ***时锚*** 的每个 ***Unix 时间戳*** 分别相加，并保存到该 ***电子书*** 中

  - ***电子书*** 的 ***可变*** 属性为真时，可以调整该 ***电子书*** 在 ***展示系统*** 中的 ***相对时间原点***

  > 图 10. 剧本创作工具

### 4. 分栏

  - 每本 ***电子书*** 在不同列中展示

  - 不同列中使用相同的 ***Meta 时间轴***

  > 图 11. 多本电子书效果

### 5. 系统接口

  - ***展示系统*** 可以接入 ***子系统***，对展示的 ***事件组*** 的 ***HTML 文本*** 产生影响

  - ***展示系统*** 中，每个 ***子系统*** 有 ***子系统设置***，由 ***子系统*** 提供

  - ***展示系统*** 在渲染前会将当前正在渲染的 ***事件组*** 的 ***文本***、***所在位置***、***子系统设置值*** 交由子系统处理

  - ***子系统*** 返回经过处理的 ***文本***，作为 ***事件组*** 的显示

  - ***展示系统*** 根据 ***事件组*** 的展示顺序，依次进行 ***子系统*** 的处理

  > 图 12. 系统处理时序

## 子系统

### 1. 词典

  - 1 本 ***词典*** 有多个 ***词条***

  - 1 本 ***词典*** 有 1 个 ***语种***

  - 1 本 ***词典*** 有 1 个 ***词典名称***

  - 1 个 ***词条*** 有 1 个 ***专名类型***

  - ***专名类型*** 可以是：***伪专名***、***真专名：人名***、***真专名：地名***、***真专名：其他***

  - 词典系统有 ***编辑界面***，用于录入 ***词条***

  - ***编辑界面*** 中，可以打开多本 ***词典***

  - 不同 ***词典***，通过 ***词条*** 的 ID 确定一一对应的关系

  > 图 13. 词典录入工具
  
![](https://github.com/Kampare/kampare-website/blob/master/images/fig13.png)

### 2. 词典接入

  - ***展示系统*** 中，一本 ***电子书*** 的 ***语种***，为 ***主语言***

  - ***展示系统*** 对词典系统的 ***子系统设置*** 中，设置当前展示 ***电子书*** 的 ***翻译语言***

  - ***展示系统*** 中，一个 ***词条*** 若为 ***真专名：人名***，则以 "***翻译语言***(***主语言***)" 的模板展示

  - ***展示系统*** 中，一个 ***词条*** 若为 ***真专名：地名***，则以 "***翻译语言***<***主语言***>" 的模板展示

  - ***展示系统*** 中，一个 ***词条*** 若为 ***真专名：其他***，则以 "***翻译语言***[***主语言***]" 的模板展示

  - ***展示系统*** 中，一个 ***词条*** 若为 ***伪专名***，则以 "***主语言***(***翻译语言***)" 的模板展示

  - ***展示系统*** 中，若多个 ***事件组*** 拥有同一词条，则第一个 ***事件组*** 中第一次出现的 ***词条*** 为 ***首次出现词条***

  - ***展示系统*** 中，若 ***首次出现词条*** 为 ***真专名*** 则该 ***词条*** 以模板展示，否则以 ***翻译语言*** 加下划线展示

  > 图 14. 词典在展示系统的影响
